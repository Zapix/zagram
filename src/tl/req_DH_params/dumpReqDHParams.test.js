import {
  METHOD_KEY,
  REQ_DH_PARAMS_METHOD,
  SERVER_DH_PARAMS_TYPE,
  TYPE_KEY,
} from '../../constants';
import dumpReqDHParams from './dumpReqDHParams';
import { arrayBufferToHex } from '../../utils';

describe('dumpReqDHParams', () => {
  it('test', () => {
    const obj = {
      [TYPE_KEY]: SERVER_DH_PARAMS_TYPE,
      [METHOD_KEY]: REQ_DH_PARAMS_METHOD,
      nonce: BigInt('0x8dcfcbf2ee27d8e785d1962ea1af3dd7'),
      server_nonce: BigInt('0x2f015ca9533aac03524a716ec11cd433'),
      p: [72, 142, 110, 125],
      q: [100, 212, 8, 23],
      fingerprint: BigInt('0xc3b42b026ce86b21'),
      /* eslint-disable */
      encrypted_data: [90,112,196,24,83,96,199,211,238,247,37,243,158,226,2,100,15,198,204,147,22,221,212,18,130,32,18,170,57,153,151,162,219,228,152,56,100,76,1,212,3,42,186,203,217,119,185,233,220,28,178,25,253,244,8,84,225,87,75,245,70,243,84,102,131,202,177,190,60,96,170,88,14,234,174,164,86,228,230,73,40,134,28,201,185,93,24,45,57,65,158,39,234,78,179,229,12,141,80,36,26,142,74,110,190,96,165,142,255,28,218,36,130,8,143,108,226,61,249,200,231,15,232,150,189,44,217,139,232,104,176,29,72,102,185,44,41,27,220,0,39,95,91,18,101,208,101,139,46,141,143,88,124,114,114,27,248,148,7,103,53,129,72,123,121,0,168,155,184,93,176,54,222,72,74,104,50,105,155,2,88,173,38,229,173,168,51,91,204,21,61,215,200,132,108,41,21,200,221,91,171,236,29,73,69,15,8,126,90,161,238,169,17,139,51,2,84,51,125,2,53,116,17,59,144,141,71,218,44,135,129,57,230,168,217,144,151,117,49,139,150,94,33,183,56,66,184,23,248,90,75,110,196,12,247,48],
      /* eslint-enable */
    };

    const buffer = dumpReqDHParams(obj);

    /* eslint-disable */
    const hexStr = 'bee412d7d73dafa12e96d185e7d827eef2cbcf8d33d41cc16e714a5203ac3a53a95c012f04488e6e7d0000000464d40817000000216be86c022bb4c3fe0001005a70c4185360c7d3eef725f39ee202640fc6cc9316ddd412822012aa399997a2dbe49838644c01d4032abacbd977b9e9dc1cb219fdf40854e1574bf546f3546683cab1be3c60aa580eeaaea456e4e64928861cc9b95d182d39419e27ea4eb3e50c8d50241a8e4a6ebe60a58eff1cda2482088f6ce23df9c8e70fe896bd2cd98be868b01d4866b92c291bdc00275f5b1265d0658b2e8d8f587c72721bf89407673581487b7900a89bb85db036de484a6832699b0258ad26e5ada8335bcc153dd7c8846c2915c8dd5babec1d49450f087e5aa1eea9118b330254337d023574113b908d47da2c878139e6a8d9909775318b965e21b73842b817f85a4b6ec40cf730';
    /* eslint-enable */

    expect(arrayBufferToHex(buffer)).toEqual(hexStr);
  });
});
