import { arrayBufferToHex } from '../../utils';
import {
  METHOD_KEY,
  SET_CLIENT_DH_PARAMS_ANSWER_TYPE,
  SET_CLIENT_DH_PARAMS_METHOD,
  TYPE_KEY,
} from '../../constants';
import dumpSetClientDHParams from './dumpSetClientDHParams';

describe('dumpSetClientDHParams', () => {
  it('test', () => {
    const obj = {
      [TYPE_KEY]: SET_CLIENT_DH_PARAMS_ANSWER_TYPE,
      [METHOD_KEY]: SET_CLIENT_DH_PARAMS_METHOD,
      nonce: BigInt('0x27f24aa3ebc86134279c8ab4821c35bc'),
      server_nonce: BigInt('0xcaa52cd76e473e4923c2daf84171a6c0'),
      /* eslint-disable */
      encrypted_data: [123,123,18,223,201,171,37,29,55,165,80,164,253,178,22,29,215,164,240,4,38,19,99,252,126,237,189,14,78,50,4,112,176,173,244,194,198,53,97,206,17,44,193,147,16,104,168,62,207,213,114,33,26,252,161,101,210,115,177,143,87,97,104,65,96,158,214,192,114,51,148,15,250,7,61,217,2,106,50,22,251,190,29,250,231,244,188,197,190,84,8,43,126,35,231,200,161,220,41,83,173,150,204,43,7,9,117,97,138,68,65,129,190,201,233,60,35,170,34,41,193,206,147,50,30,104,57,216,37,236,245,128,158,210,183,95,78,138,135,43,209,193,237,79,205,253,203,70,227,139,54,40,235,171,22,78,156,158,251,254,207,111,72,66,127,151,28,155,153,43,70,72,161,188,22,98,231,89,249,195,140,31,242,110,177,55,173,159,201,177,160,21,163,138,112,132,24,60,65,129,83,34,1,15,243,216,216,109,231,246,195,244,18,160,184,151,3,201,58,5,224,5,236,189,89,138,148,129,62,30,238,185,61,252,9,95,114,247,23,208,201,82,109,238,204,157,115,227,252,146,40,161,149,120,33,130,24,62,132,80,205,136,163,2,239,136,120,216,204,111,207,221,132,7,210,73,84,166,190,255,43,197,7,172,230,253,65,144,86,140,147,247,231,20,231,15,131,56,29,13,108,27,56,102,84,18,225,48,84,60,64,115,113,61,181,207,183,203,20,107,127,72,243,144,199,158,31,190,111,207,85,74,105,6,139,64],
      /* eslint-enable */
    };

    const buffer = dumpSetClientDHParams(obj);

    /* eslint-disable */
    const hexStr = '1f5f04f5bc351c82b48a9c273461c8eba34af227c0a67141f8dac223493e476ed72ca5cafe5001007b7b12dfc9ab251d37a550a4fdb2161dd7a4f004261363fc7eedbd0e4e320470b0adf4c2c63561ce112cc1931068a83ecfd572211afca165d273b18f57616841609ed6c07233940ffa073dd9026a3216fbbe1dfae7f4bcc5be54082b7e23e7c8a1dc2953ad96cc2b070975618a444181bec9e93c23aa2229c1ce93321e6839d825ecf5809ed2b75f4e8a872bd1c1ed4fcdfdcb46e38b3628ebab164e9c9efbfecf6f48427f971c9b992b4648a1bc1662e759f9c38c1ff26eb137ad9fc9b1a015a38a7084183c41815322010ff3d8d86de7f6c3f412a0b89703c93a05e005ecbd598a94813e1eeeb93dfc095f72f717d0c9526deecc9d73e3fc9228a195782182183e8450cd88a302ef8878d8cc6fcfdd8407d24954a6beff2bc507ace6fd4190568c93f7e714e70f83381d0d6c1b38665412e130543c4073713db5cfb7cb146b7f48f390c79e1fbe6fcf554a69068b40';
    /* eslint-enable */

    expect(arrayBufferToHex(buffer)).toEqual(hexStr);
  });
});
