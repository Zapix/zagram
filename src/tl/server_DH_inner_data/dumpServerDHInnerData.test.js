import {
  CONSTRUCTOR_KEY,
  SERVER_DH_INNER_DATA_CONSTRUCTOR,
  SERVER_DH_INNER_DATA_TYPE,
  TYPE_KEY,
} from '../../constants';
import dumpServerDHInnerData from './dumpServerDHInnerData';
import { arrayBufferToHex } from '../../utils';

describe('dumpServerDHInnerData', () => {
  it('test', () => {
    const obj = {
      [TYPE_KEY]: SERVER_DH_INNER_DATA_TYPE,
      [CONSTRUCTOR_KEY]: SERVER_DH_INNER_DATA_CONSTRUCTOR,
      nonce: BigInt('0x923f00780580a638412a0b40dc2b4685'),
      server_nonce: BigInt('0x1cf9a119ce7c8e210ae1adad04e48e20'),
      g: 3,
      /* eslint-disable */
      dh_prime: [199,28,174,185,198,177,201,4,142,108,82,47,112,241,63,115,152,13,64,35,142,62,33,193,73,52,208,55,86,61,147,15,72,25,138,10,167,193,64,88,34,148,147,210,37,48,244,219,250,51,111,110,10,201,37,19,149,67,174,212,76,206,124,55,32,253,81,246,148,88,112,90,198,140,212,254,107,107,19,171,220,151,70,81,41,105,50,132,84,241,143,175,140,89,95,100,36,119,254,150,187,42,148,29,91,205,29,74,200,204,73,136,7,8,250,155,55,142,60,79,58,144,96,190,230,124,249,164,164,166,149,129,16,81,144,126,22,39,83,181,107,15,107,65,13,186,116,216,168,75,42,20,179,20,78,14,241,40,71,84,253,23,237,149,13,89,101,180,185,221,70,88,45,177,23,141,22,156,107,196,101,176,214,255,156,163,146,143,239,91,154,228,228,24,252,21,232,62,190,160,248,127,169,255,94,237,112,5,13,237,40,73,244,123,249,89,217,86,133,12,233,41,133,31,13,129,21,246,53,177,5,238,46,78,21,208,75,36,84,191,111,79,173,240,52,177,4,3,17,156,216,227,185,47,204,91],
      g_a: [169,126,45,64,202,129,79,96,35,220,235,22,71,131,211,7,42,72,87,73,26,230,62,210,150,190,99,202,21,225,55,180,167,160,51,133,86,249,51,14,153,74,199,54,91,187,252,32,81,176,218,123,91,81,88,40,239,250,43,72,220,209,75,40,100,33,32,103,206,246,62,83,228,66,245,214,106,64,226,46,111,107,139,245,59,26,212,16,93,208,39,78,70,98,76,15,240,18,155,38,27,175,16,164,204,177,182,76,115,161,133,60,149,176,120,93,181,213,239,76,161,101,217,1,237,202,177,21,199,242,141,200,223,164,147,201,12,254,173,183,216,214,144,150,82,26,171,145,225,177,13,86,12,180,201,13,183,80,240,250,151,227,13,116,89,77,142,174,253,253,29,253,13,209,175,79,96,59,248,11,64,64,25,182,173,176,184,93,228,241,72,208,22,80,99,209,198,17,68,32,241,1,132,251,91,5,153,233,5,138,150,3,168,86,229,17,182,248,85,144,182,152,127,251,247,247,197,186,158,163,47,173,88,11,213,141,22,172,169,169,55,37,236,50,217,8,68,64,33,203,86,234,85,245,62,141],
      /* eslint-enable */
      server_time: 1594225273,
    };

    const buffer = dumpServerDHInnerData(obj);

    /* eslint-disable */
    const hexStr = 'ba0d89b585462bdc400b2a4138a6800578003f92208ee404adade10a218e7cce19a1f91c03000000fe000100c71caeb9c6b1c9048e6c522f70f13f73980d40238e3e21c14934d037563d930f48198a0aa7c14058229493d22530f4dbfa336f6e0ac925139543aed44cce7c3720fd51f69458705ac68cd4fe6b6b13abdc9746512969328454f18faf8c595f642477fe96bb2a941d5bcd1d4ac8cc49880708fa9b378e3c4f3a9060bee67cf9a4a4a695811051907e162753b56b0f6b410dba74d8a84b2a14b3144e0ef1284754fd17ed950d5965b4b9dd46582db1178d169c6bc465b0d6ff9ca3928fef5b9ae4e418fc15e83ebea0f87fa9ff5eed70050ded2849f47bf959d956850ce929851f0d8115f635b105ee2e4e15d04b2454bf6f4fadf034b10403119cd8e3b92fcc5bfe000100a97e2d40ca814f6023dceb164783d3072a4857491ae63ed296be63ca15e137b4a7a0338556f9330e994ac7365bbbfc2051b0da7b5b515828effa2b48dcd14b2864212067cef63e53e442f5d66a40e22e6f6b8bf53b1ad4105dd0274e46624c0ff0129b261baf10a4ccb1b64c73a1853c95b0785db5d5ef4ca165d901edcab115c7f28dc8dfa493c90cfeadb7d8d69096521aab91e1b10d560cb4c90db750f0fa97e30d74594d8eaefdfd1dfd0dd1af4f603bf80b404019b6adb0b85de4f148d0165063d1c6114420f10184fb5b0599e9058a9603a856e511b6f85590b6987ffbf7f7c5ba9ea32fad580bd58d16aca9a93725ec32d908444021cb56ea55f53e8d79f2055f';
    /* eslint-enable */

    expect(arrayBufferToHex(buffer)).toEqual(hexStr);
  });
});
