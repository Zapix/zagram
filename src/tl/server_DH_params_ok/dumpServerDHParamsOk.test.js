import {
  CONSTRUCTOR_KEY,
  SERVER_DH_PARAMS_OK_CONSTRUCTOR,
  SERVER_DH_PARAMS_TYPE,
  TYPE_KEY,
} from '../../constants';
import dumpServerDHParamsOk from './dumpServerDHParamsOk';
import { arrayBufferToHex } from '../../utils';

describe('dumpServerDHParamsOK', () => {
  it('test', () => {
    const obj = {
      [TYPE_KEY]: SERVER_DH_PARAMS_TYPE,
      [CONSTRUCTOR_KEY]: SERVER_DH_PARAMS_OK_CONSTRUCTOR,
      nonce: BigInt('0x19fd35605cfd0ba35810d6639b50d28a'),
      server_nonce: BigInt('0x60d47825536f4b0a5804adade13ba944'),
      /* eslint-disable */
      encrypted_answer: [192,238,28,102,82,246,106,222,47,14,214,67,80,24,203,117,17,208,228,82,174,230,141,172,222,93,126,251,112,24,119,162,16,225,90,16,4,148,236,208,58,136,98,171,126,87,90,190,44,161,143,45,136,243,235,132,206,236,35,48,222,73,70,11,72,234,79,1,60,147,237,188,244,67,63,228,31,75,62,98,210,38,220,41,130,136,145,20,87,242,21,128,12,254,53,152,3,0,242,128,229,80,238,178,21,238,167,166,227,205,46,87,41,56,6,35,66,221,62,248,155,128,58,65,1,153,254,9,125,248,224,130,146,53,149,238,177,64,106,75,143,31,17,222,24,116,144,39,221,60,182,62,196,54,202,204,87,118,186,45,167,28,173,137,32,156,47,250,37,184,210,84,162,220,55,86,39,247,228,92,217,41,251,146,229,143,41,234,180,84,255,80,82,24,110,21,179,206,127,28,17,255,254,29,138,117,168,219,74,29,117,101,102,139,170,200,20,199,25,106,22,251,148,191,161,201,11,109,137,248,148,159,233,19,164,48,132,232,225,232,154,74,139,152,55,97,44,239,47,152,246,87,126,159,172,164,72,202,134,163,225,129,198,18,171,36,86,142,142,252,161,73,200,215,73,110,84,67,133,72,108,206,50,43,133,231,8,229,32,23,144,47,72,211,125,29,105,15,235,127,197,89,0,77,75,210,117,5,133,28,90,46,68,169,69,45,13,18,94,14,246,34,248,208,67,106,212,223,78,162,103,111,102,187,192,88,201,165,218,214,245,37,173,219,56,30,58,4,48,152,154,70,223,213,157,181,210,38,65,90,158,45,161,165,183,47,48,55,99,210,169,233,235,118,92,137,154,199,18,149,197,144,66,224,3,72,233,42,104,98,15,129,110,178,67,69,202,16,180,116,194,126,108,254,59,199,73,232,66,52,213,89,205,238,187,123,48,48,223,72,42,211,253,249,73,38,205,239,230,220,251,80,45,156,0,48,232,166,52,230,184,35,105,34,251,247,95,178,150,116,124,48,139,119,165,37,49,228,178,152,32,28,141,31,133,99,246,134,67,70,217,115,206,195,36,116,58,193,106,43,86,28,96,136,74,220,179,234,214,10,119,164,147,219,80,222,104,216,78,248,54,57,182,184,21,185,51,217,5,125,242,28,60,191,206,4,182,116,144,233,26,90,107,175,251,151,169,195,181,206,246,115,152,32,74,143,51,230,6,163,178,2,56,190,134,160,70,148,59,107,76,63,139,187,205,119,59,247,51,50,126,91,117,162,65,160,50,88,204,58,244,11,176,106,167,112,254,92,78,13,134,23,29,27,203,201,186,57,55,63,207,139],
      /* eslint-enable */
    };

    const buffer = dumpServerDHParamsOk(obj);

    /* eslint-disable */
    const hexStr = '5c07e8d08ad2509b63d61058a30bfd5c6035fd1944a93be1adad04580a4b6f532578d460fe500200c0ee1c6652f66ade2f0ed6435018cb7511d0e452aee68dacde5d7efb701877a210e15a100494ecd03a8862ab7e575abe2ca18f2d88f3eb84ceec2330de49460b48ea4f013c93edbcf4433fe41f4b3e62d226dc298288911457f215800cfe35980300f280e550eeb215eea7a6e3cd2e572938062342dd3ef89b803a410199fe097df8e082923595eeb1406a4b8f1f11de18749027dd3cb63ec436cacc5776ba2da71cad89209c2ffa25b8d254a2dc375627f7e45cd929fb92e58f29eab454ff5052186e15b3ce7f1c11fffe1d8a75a8db4a1d7565668baac814c7196a16fb94bfa1c90b6d89f8949fe913a43084e8e1e89a4a8b9837612cef2f98f6577e9faca448ca86a3e181c612ab24568e8efca149c8d7496e544385486cce322b85e708e52017902f48d37d1d690feb7fc559004d4bd27505851c5a2e44a9452d0d125e0ef622f8d0436ad4df4ea2676f66bbc058c9a5dad6f525addb381e3a0430989a46dfd59db5d226415a9e2da1a5b72f303763d2a9e9eb765c899ac71295c59042e00348e92a68620f816eb24345ca10b474c27e6cfe3bc749e84234d559cdeebb7b3030df482ad3fdf94926cdefe6dcfb502d9c0030e8a634e6b8236922fbf75fb296747c308b77a52531e4b298201c8d1f8563f6864346d973cec324743ac16a2b561c60884adcb3ead60a77a493db50de68d84ef83639b6b815b933d9057df21c3cbfce04b67490e91a5a6baffb97a9c3b5cef67398204a8f33e606a3b20238be86a046943b6b4c3f8bbbcd773bf733327e5b75a241a03258cc3af40bb06aa770fe5c4e0d86171d1bcbc9ba39373fcf8b';
    /* eslint-enable */

    expect(arrayBufferToHex(buffer)).toEqual(hexStr);
  });
});
